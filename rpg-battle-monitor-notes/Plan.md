- [ ] Right sidebar
	- [ ] Token management
		- [x] Display list of tokens
			- [ ] Possible organisation with folders
				- [ ] Default display
				- [ ] Per user
			- [x] Drag tokens onto board
				- [x] Detect where the token is getting dropped
				- [x] Create token entity on the board
				- [x] Position token better - currently it usually isn't dropped where expected
		- [x] Adding new token data
		- [x] Token health bar ??
		- [x] Draw floating ui around selected token ??
	- [ ] Log
		- [ ] Log message type - based on type choose how to display the message
		- [ ] Paginated message handling on the server - only last x messages need to be shown to the user and scrolling/pagination can request for more

- [ ] Character customisation
	- [x] Changing token image
	- [ ] Changing character stats
		- [ ] Character builder
		- [ ] Built in monsters
- [ ] Turn order
	- [x] Add tokens on scene to turn display
	- [x] Calculate their turn order as they are placed
	- [ ] Start turn
		- [x] Start with display who's turn it is
		- [ ] Hide monster turn order from players
			- [ ] Hide for monsters in combat, but out of sight
	- [ ] Moving during combat
		- [x] Draw a line from start to end point 
			- [x] Raytrace from mouse start position to current position. From cells that collide with the ray find the shortest path to the mouse position, highlight those cells
		![[Pasted image 20250924184914.png]]
		- [x] Display ft moved based on character speed
			- [x] For other players display a line where the character attempts to move to
		- [x] Display speed left to use in turn
		- [x] Disallow moving beyond character speed
		- [x] Disallow moving to same space as enemy 
		- [ ] Add harsh terrain
			- [ ] Double speed used when passing
- [ ] Walls
	- [ ] Wall layer
		- [ ] Placing walls
		- [ ] Connecting walls
		- [ ] Doors
		- [ ] Windows
	- [ ] Line of sight calculation/display
- [ ] Combat
	- [ ] Logic
		- [ ] Choose skill to use
		- [ ] For each token that is not friendly
			- [ ] Add friendly logic
				- [x] Add tag list to token data
				- [ ] Check for existence of a tag "friendly" tag when highlighting tokens (this can be maybe team based, so group and friendly npc tokens can be assigned one group while any hostile tokens can be assigned another group)
			- [x] "Draw" a line from the attacking token to other tokens
			- [x] Check if line is in skill range, e.g. 5 ft
			- [x] Highlight all tokens in skill range
			- [ ] Some spells/attacks don't require a target
		- [ ] Target selection logic
			- [x] Overlay token layer
			- [x] Highlight valid token targets
			- [ ] If attack/spell is targeted only allow clicking on highlighted tokens
			- [ ] If attack/spell can have free selection allow clicking any cell
		- [ ] AoE spells
			- [ ] Line
			- [ ] Cone
			- [ ] Cube
			- [ ] Sphere
	- [ ] Add melee attack
		- [x] Highlight attackable tokens in range
		- [x] Roll for hit
			- [x] If hit roll for damage
			- [ ] Display rolls to users
			- [x] If hit and damaged update health of target
	- [ ] Add ranged attack
		- [ ] Add at least one spell
		- [ ] Raytrace between start and target, if in range and target is seen roll for hit/damage
	- [ ] Action display
		- [ ] List all actions a token can do
			- [ ] Group by spells, cantrips, melee, other (help, revive, use potion...)
- [ ] Animate move can work like this
	- [ ] on applyUpdateAction add animation to queue
	- [ ] animation is queued until a transitive message with the right id is received
	- [ ] if multiple messages are received for animating they must be queued and played one after other
	- [ ] Animator class should clear the queue by itself if animations are stale (sitting in queue for 30 seconds)
- [ ] Clone token data so multiple of the same npc can be added